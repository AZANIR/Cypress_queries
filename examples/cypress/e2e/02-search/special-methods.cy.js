// ============================================================
// ТЕМА: Спеціальні методи - focused(), invoke(), its(), title()
// ОПИС: Демонстрація спеціальних методів для роботи з елементами
//       та властивостями браузера
// ============================================================

describe('Спеціальні методи - робота з властивостями та станом', () => {
  // Підготовка: відкриваємо сторінку перед кожним тестом
  beforeEach(() => {
    cy.visit('/')
  })

  // Тест 1: focused() - знаходження елемента у фокусі
  // focused() - знаходить елемент, який зараз має фокус (активний для вводу)
  it('має знайти елемент у фокусі через focused()', () => {
    // cy.get('.new-todo') - знаходимо поле вводу
    // .focus() - встановлюємо фокус на елемент
    // focus() робить елемент активним для вводу тексту
    cy.get('.new-todo')
      .focus()
    
    // cy.focused() - знаходить елемент, який зараз у фокусі
    // Це корисно, коли не знаємо точно, який елемент активний
    cy.focused()
      // Перевіряємо, що це дійсно поле вводу
      .should('have.class', 'new-todo')
      // Перевіряємо, що елемент видимий
      .should('be.visible')
  })

  // Тест 2: invoke() - виклик методів на елементі
  // invoke() - викликає метод jQuery або DOM API на елементі
  it('має викликати методи через invoke()', () => {
    // cy.get('.new-todo') - знаходимо поле вводу
    // .invoke('val', 'Тестовий текст') - викликаємо метод val() з параметром
    // val() - jQuery метод для встановлення значення input
    cy.get('.new-todo')
      .invoke('val', 'Тестовий текст')
      // Перевіряємо, що значення встановлено
      .should('have.value', 'Тестовий текст')
    
    // invoke() для виклику DOM методів
    // .invoke('focus') - викликаємо метод focus() на елементі
    cy.get('.new-todo')
      .invoke('focus')
      // Перевіряємо, що елемент у фокусі
      .should('be.focused')
  })

  // Тест 3: its() - отримання властивостей об'єкта
  // its() - отримує значення властивості об'єкта або елемента
  it('має отримати властивості через its()', () => {
    // cy.get('.new-todo') - знаходимо поле вводу
    // .its('length') - отримуємо властивість length
    // У цьому випадку length = 1 (знайдено один елемент)
    cy.get('.new-todo')
      .its('length')
      .should('eq', 1)
    
    // its() для отримання властивостей jQuery об'єкта
    // .its('0') - отримуємо перший елемент з jQuery об'єкта
    // Потім .its('tagName') - отримуємо tagName DOM елемента
    cy.get('.new-todo')
      .its('0')
      .its('tagName')
      .should('eq', 'INPUT')
    
    // Коротший спосіб - ланцюжок властивостей
    // .its('0.tagName') - отримуємо tagName через ланцюжок
    cy.get('.new-todo')
      .its('0.tagName')
      .should('eq', 'INPUT')
  })

  // Тест 4: title() - отримання заголовка сторінки
  // title() - отримує значення document.title (заголовок сторінки)
  it('має отримати заголовок сторінки через title()', () => {
    // cy.title() - отримує заголовок сторінки
    // Це значення з тега <title> в HTML
    cy.title()
      // Перевіряємо, що заголовок містить "React" (TodoMVC React)
      .should('include', 'React')
    
    // title() можна використовувати для перевірки правильності сторінки
    // Якщо заголовок не відповідає очікуваному, щось не так
    cy.title()
      .should('not.be.empty')
  })

  // Тест 5: Комбінація invoke() та its()
  // Можна комбінувати invoke() та its() для складних операцій
  it('має комбінувати invoke() та its()', () => {
    // Встановлюємо значення через invoke()
    cy.get('.new-todo')
      .invoke('val', 'Комбінований тест')
    
    // Отримуємо значення через its()
    // .its('0.value') - отримуємо value DOM елемента
    cy.get('.new-todo')
      .its('0.value')
      .should('eq', 'Комбінований тест')
  })

  // Тест 6: invoke() для виклику кастомних методів
  // invoke() може викликати будь-які методи, доступні на елементі
  it('має викликати різні методи через invoke()', () => {
    // invoke() для jQuery методів
    // .invoke('show') - показує прихований елемент (якщо він був прихований)
    cy.get('.new-todo')
      .invoke('show')
      .should('be.visible')
    
    // invoke() для DOM методів
    // .invoke('blur') - прибирає фокус з елемента
    cy.get('.new-todo')
      .focus()
      .invoke('blur')
      .should('not.be.focused')
  })

  // Тест 7: Практичний приклад - перевірка стану елемента
  // Використання спеціальних методів для перевірки стану
  it('має використовувати спеціальні методи для перевірки стану', () => {
    // Перевіряємо, що поле вводу порожнє
    cy.get('.new-todo')
      .its('0.value')
      .should('eq', '')
    
    // Вводимо текст
    cy.get('.new-todo')
      .type('Тестова задача')
    
    // Перевіряємо значення через its()
    cy.get('.new-todo')
      .its('0.value')
      .should('eq', 'Тестова задача')
    
    // Перевіряємо, що елемент у фокусі після вводу
    cy.focused()
      .should('have.class', 'new-todo')
  })
})

// ============================================================
// ВАЖЛИВІ ЗАУВАЖЕННЯ про спеціальні методи:
// ============================================================
// focused() - знаходить елемент у фокусі (активний для вводу)
// invoke() - викликає методи jQuery або DOM API на елементі
// its() - отримує значення властивості об'єкта або елемента
// title() - отримує заголовок сторінки (document.title)
//
// Всі ці методи працюють з вже знайденими елементами
// Вони дозволяють отримувати інформацію про стан елементів
// та взаємодіяти з ними на низькому рівні
// ============================================================
