// ============================================================
// ТЕМА: Навігаційні ланцюжки - nextAll(), nextUntil(), prevAll(), prevUntil(), parents()
// ОПИС: Демонстрація методів для навігації по сусідніх та батьківських елементах
// ============================================================

describe('Навігаційні ланцюжки - складні навігації', () => {
  // Підготовка: відкриваємо сторінку та додаємо тестові дані
  beforeEach(() => {
    cy.visit('/')
    cy.get('.new-todo').type('Задача 1{enter}')
    cy.get('.new-todo').type('Задача 2{enter}')
    cy.get('.new-todo').type('Задача 3{enter}')
    cy.get('.new-todo').type('Задача 4{enter}')
  })

  // Тест 1: nextAll() - всі наступні сусідні елементи
  // nextAll() - знаходить всі наступні сусідні елементи
  it('має знайти всі наступні елементи через nextAll()', () => {
    // cy.get('.todo-list li').first() - перший елемент
    // .nextAll() - всі наступні сусідні елементи
    cy.get('.todo-list li')
      .first()
      .nextAll()
      // Має бути 3 наступні елементи (2, 3, 4)
      .should('have.length', 3)
  })

  // Тест 2: prevAll() - всі попередні сусідні елементи
  // prevAll() - знаходить всі попередні сусідні елементи
  it('має знайти всі попередні елементи через prevAll()', () => {
    // cy.get('.todo-list li').last() - останній елемент
    // .prevAll() - всі попередні сусідні елементи
    cy.get('.todo-list li')
      .last()
      .prevAll()
      // Має бути 3 попередні елементи (1, 2, 3)
      .should('have.length', 3)
  })

  // Тест 3: nextUntil() - наступні елементи до певного
  // nextUntil() - знаходить наступні елементи до елемента, що відповідає селектору
  it('має знайти наступні елементи до певного через nextUntil()', () => {
    // .nextUntil('.todo-list li:last-child') - наступні елементи до останнього
    cy.get('.todo-list li')
      .first()
      .nextUntil('.todo-list li:last-child')
      // Має бути 2 елементи (2, 3) - до останнього, але не включаючи його
      .should('have.length', 2)
  })

  // Тест 4: prevUntil() - попередні елементи до певного
  // prevUntil() - знаходить попередні елементи до елемента, що відповідає селектору
  it('має знайти попередні елементи до певного через prevUntil()', () => {
    // .prevUntil('.todo-list li:first-child') - попередні елементи до першого
    cy.get('.todo-list li')
      .last()
      .prevUntil('.todo-list li:first-child')
      // Має бути 2 елементи (2, 3) - до першого, але не включаючи його
      .should('have.length', 2)
  })

  // Тест 5: parents() - всі батьківські елементи
  // parents() - знаходить всі батьківські елементи (не тільки безпосередній)
  it('має знайти всі батьківські елементи через parents()', () => {
    // cy.get('.toggle') - знаходимо чекбокс (глибоко вкладений)
    // .parents() - всі батьківські елементи
    cy.get('.toggle')
      .first()
      .parents()
      // Має знайти кілька батьківських елементів (li, ul, body, html тощо)
      .should('have.length.greaterThan', 1)
    
    // parents() з селектором - тільки батьківські елементи, що відповідають селектору
    cy.get('.toggle')
      .first()
      .parents('li')
      // Має знайти li елемент
      .should('have.length', 1)
  })

  // Тест 6: Комбінація навігаційних методів
  // Можна комбінувати різні навігаційні методи
  it('має комбінувати навігаційні методи', () => {
    // Знаходимо другий елемент
    cy.get('.todo-list li')
      .eq(1)
      // Знаходимо попередній елемент
      .prev()
      .should('contain', 'Задача 1')
    
    // Знаходимо другий елемент
    cy.get('.todo-list li')
      .eq(1)
      // Знаходимо наступний елемент
      .next()
      .should('contain', 'Задача 3')
  })
})

// ============================================================
// ВАЖЛИВІ ЗАУВАЖЕННЯ про навігаційні ланцюжки:
// ============================================================
// 1. nextAll() - всі наступні сусідні елементи
// 2. prevAll() - всі попередні сусідні елементи
// 3. nextUntil(селектор) - наступні до елемента, що відповідає селектору
// 4. prevUntil(селектор) - попередні до елемента, що відповідає селектору
// 5. parents() - всі батьківські елементи (не тільки безпосередній)
// 6. Всі ці методи працюють на вже знайдених елементах
// ============================================================
